{
    "id": "urn:ietf:params:scim:schemas:extension:account:2.0:Password",
    "name": "Password Management Schema Extension",
    "description": "This extension defines attributes used to manage account passwords within a service provider.  The extension is typically applied to a User resource, but MAY be applied to other resources that use passwords.",
    "attributes": [
        {
            "name": "passwordState",
            "type": "complex",
            "multiValued": false,
            "description": "A Complex attribute that describes server provided attributes regarding the state of the resource's password.",
            "required": true,
            "returned": "default",
            "mutability": "readWrite",
            "subAttributes": [
                {
                    "name": "createDate",
                    "type": "dateTime",
                    "multiValued": false,
                    "description": "A DateTime which specifies the date and time the current password was set.",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "cantChange",
                    "type": "boolean",
                    "multiValued": false,
                    "description": "A Boolean indicating that the current password MAY NOT be changed and all other password expiry settings SHALL be ignored",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "noExpiry",
                    "type": "boolean",
                    "multiValued": false,
                    "description": "A Boolean indicating that password expiry policy will not be applied for the current resource.",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "lastSuccessfulLoginDate",
                    "type": "dateTime",
                    "multiValued": false,
                    "description": "A DateTime value indicating the lastsuccessful login date.",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "lastFailedLoginDate",
                    "type": "dateTime",
                    "multiValued": false,
                    "description": "A DateTime value indicating the last failed login date.",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "loginAttempts",
                    "type": "integer",
                    "multiValued": false,
                    "description": "An Integer value indicating the number of failed login attempts. The value is reset to 0 after a successfull login.",
                    "required": false,
                    "mutability": "readOnly",
                    "returned": "default"
                },
                {
                    "name": "resetAttempts",
                    "type": "integer",
                    "multiValued": false,
                    "description": "An Integer value indicating the number of password reset attempts. The value is reset to 0 after successful reset.",
                    "required": false,
                    "mutability": "readOnly",
                    "returned": "default"
                },
                {
                    "name": "passwordMustChange",
                    "type": "boolean",
                    "multiValued": false,
                    "description": "A Boolean value that indicates that the subject password value MUST change at the next login. If not changed, typically the account is locked The value may be set indirectly when the subject's current password expires, or directly set by an administrator.",
                    "required": false,
                    "mutability": "readWrite",
                    "returned": "default"
                },
                {
                    "name": "passwordPolicyUrl",
                    "type": "reference",
                    "referenceTypes": [
                        "PasswordPolicy"
                    ],
                    "multiValued": false,
                    "description": "A URI reference value that indicates the address of a password policy that is used in relation to the current resource.",
                    "required": false,
                    "caseExact": false,
                    "mutability": "readWrite",
                    "returned": "default",
                    "uniqueness": "none"
                },
                {
                    "name": "locked",
                    "type": "complex",
                    "multiValued": false,
                    "description": "A Complex attribute that indicates an account is locked (blocking new sessions).",
                    "required": false,
                    "returned": "default",
                    "mutability": "readWrite",
                    "subAttributes": [
                        {
                            "name": "reason",
                            "type": "integer",
                            "multiValued": false,
                            "description": "A number value indicating the reason for locking. Valid values are: 0 - failed attempts. 1 - admin lock. 2 - reset attempts",
                            "required": true,
                            "mutability": "readWrite",
                            "returned": "default"
                        },
                        {
                            "name": "on",
                            "type": "boolean",
                            "multiValued": false,
                            "description": "A Boolean value indicating the account is locked.",
                            "required": true,
                            "mutability": "readWrite",
                            "returned": "default"
                        },
                        {
                            "name": "lockDate",
                            "type": "dateTime",
                            "multiValued": false,
                            "description": "A DateTime which specifies the date and time the current resource was locked.",
                            "required": false,
                            "mutability": "readWrite",
                            "returned": "default"
                        }
                    ]
                },
                {
                    "name": "challenges",
                    "type": "complex",
                    "multiValued": true,
                    "description": "A Complex attribute describing challenge questions that may be used as a supplementary factor during login or during password management requests.",
                    "required": false,
                    "returned": "default",
                    "mutability": "readWrite",
                    "subAttributes": [
                        {
                            "name": "question",
                            "type": "string",
                            "multiValued": false,
                            "description": "A String that represents a challenge question for which the corresponding response is defined.",
                            "required": true,
                            "caseExact": true,
                            "mutability": "readWrite",
                            "returned": "default",
                            "uniqueness": "none"
                        },
                        {
                            "name": "response",
                            "type": "string",
                            "multiValued": false,
                            "description": "A String that represents the subjects specified correct response to the corresponding challenge.",
                            "required": true,
                            "caseExact": false,
                            "mutability": "readWrite",
                            "returned": "default",
                            "uniqueness": "none"
                        }
                    ]
                },
                {
                    "name": "passwordHistory",
                    "type": "string",
                    "multiValued": true,
                    "description": "A writeOnly attribute that contains hashes of previous passwords associated with the SCIM resource.",
                    "required": false,
                    "caseExact": true,
                    "mutability": "writeOnly",
                    "returned": "never",
                    "uniqueness": "none"
                }
            ]
        }
    ]
}